{% extends "base.html" %}

{% block title %}Bot Users{% endblock %}

{% block content %}
<h1>ðŸ‘¥ Bot Users</h1>

<div class="card">
    <div class="search-box">
        <input type="text" id="searchInput" placeholder="Search by username or name..." onkeyup="searchTable()">
    </div>

    <h2>All Users ({{ users|length }})</h2>

    <table id="usersTable">
        <thead>
            <tr>
                <th>User ID</th>
                <th>Username</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Started At</th>
            </tr>
        </thead>
        <tbody>
            {% if users %}
            {% for user in users %}
            <tr>
                <td>{{ user[0] }}</td>
                <td>@{{ user[1] or 'N/A' }}</td>
                <td>{{ user[2] or 'N/A' }}</td>
                <td>{{ user[3] or 'N/A' }}</td>
                <td>{{ user[4] }}</td>
            </tr>
            {% endfor %}
            {% else %}
            <tr>
                <td colspan="5" style="text-align: center; padding: 2rem; color: #64748b;">
                    No users found. Users will appear here when they start the bot.
                </td>
            </tr>
            {% endif %}
        </tbody>
    </table>
</div>

<script>
    function searchTable() {
        const input = document.getElementById('searchInput');
        const filter = input.value.toUpperCase();
        const table = document.getElementById('usersTable');
        const tr = table.getElementsByTagName('tr');

        for (let i = 1; i < tr.length; i++) {
            const row = tr[i];
            const cells = row.getElementsByTagName('td');
            let found = false;

            for (let j = 0; j < cells.length; j++) {
                const cell = cells[j];
                if (cell) {
                    const textValue = cell.textContent || cell.innerText;
                    if (textValue.toUpperCase().indexOf(filter) > -1) {
                        found = true;
                        break;
                    }
                }
            }

            row.style.display = found ? '' : 'none';
        }
    }
</script>
{% endblock %}